<!DOCTYPE html>
<html lang="en"><head>
<script src="06_approx_posterior_files/libs/clipboard/clipboard.min.js"></script>
<script src="06_approx_posterior_files/libs/quarto-html/tabby.min.js"></script>
<script src="06_approx_posterior_files/libs/quarto-html/popper.min.js"></script>
<script src="06_approx_posterior_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="06_approx_posterior_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="06_approx_posterior_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="06_approx_posterior_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="06_approx_posterior_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Derek Sollberger">
  <meta name="dcterms.date" content="2024-02-15">
  <title>6: Approximating the Posterior</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="06_approx_posterior_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="06_approx_posterior_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="06_approx_posterior_files/libs/revealjs/dist/theme/quarto.css">
  <link href="06_approx_posterior_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="06_approx_posterior_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="06_approx_posterior_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="06_approx_posterior_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">6: Approximating the Posterior</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Derek Sollberger 
</div>
</div>
</div>

  <p class="date">2024-02-15</p>
</section>
<section class="slide level2">


</section>
<section>
<section id="multivariate-data" class="title-slide slide level1 center">
<h1>Multivariate Data</h1>

</section>
<section id="setting-noaa" class="slide level2">
<h2>Setting: NOAA</h2>
<p>I will be studying weather data for a semester theme. The main data will probably come from <a href="https://www.noaa.gov/">NOAA</a> (National Oceanic and Atmospheric Administration), where the data consists of several readings (variables) from several research stations over many years.</p>
<p>Let <span class="math inline">\(\theta\)</span> represent the high temperature recorded. Across <span class="math inline">\(k\)</span> research stations,</p>
<p><span class="math display">\[\vec{\theta} = (\theta_{1}, \theta_{2}, ..., \theta_{k})\]</span></p>
</section>
<section id="bayesian-approach" class="slide level2">
<h2>Bayesian Approach</h2>
<p>If we have a vector of parameters to estimate,</p>
<p><span class="math display">\[f(\vec{\theta} | \vec{y} ) \propto \text{prior}*\text{likelihood} = f(\vec{\theta}) \cdot L(\vec{\theta} | \vec{y})\]</span></p>
</section>
<section id="normalizing-constant" class="slide level2">
<h2>Normalizing Constant</h2>
<p><span class="math display">\[f(y) = \displaystyle\int_{\theta_{1}}\int_{\theta_{2}} \cdots \int_{\theta_{k}} \! f(\vec{\theta}) \cdot L(\vec{\theta} | \vec{y} ) \, d\theta_{k} \cdots d\theta_{2} \, d\theta_{1}\]</span></p>
<ul>
<li>closed form solution probably does not exist</li>
<li>very expensive computationally</li>
</ul>
</section></section>
<section>
<section id="strategy" class="title-slide slide level1 center">
<h1>Strategy</h1>
<p><em>Approximate</em> the posterior distribution via simulation</p>
<ul>
<li>grid approximation, or</li>
<li>MCMC (Monte Carlo Markov Chains)</li>
</ul>
<p>Both produce a <strong>sample</strong> of <span class="math inline">\(N\)</span> <span class="math inline">\(\theta\)</span> values</p>
<p><span class="math display">\[\{ \theta^{(1)}, \theta^{(2)}, ..., \theta^{(N)} \}\]</span></p>
<p>that may have similar statistics to the posterior distribution of <span class="math inline">\(\theta\)</span>.</p>
</section>
<section id="conjugate-priors" class="slide level2">
<h2>Conjugate Priors</h2>
<p>For today, we will revisit the conjugate priors where we know a lot about the posterior distributions.</p>
<ul>
<li>Beta-Binomial</li>
</ul>
<p><span class="math display">\[\begin{array}{rrcl}
  \text{prior: } &amp; \pi &amp; \sim &amp; \text{Beta}(\alpha, \beta) \\
  \text{likelihood: } &amp; Y|\pi &amp; \sim &amp; \text{Bin}(n, \pi) \\
  \text{posterior: } &amp; \pi|Y &amp; \sim &amp; \text{Beta}(\alpha + y, \beta + n - y) \\
\end{array}\]</span></p>
<ul>
<li>Gamma-Poisson</li>
</ul>
<p><span class="math display">\[\begin{array}{rrcl}
  \text{prior: } &amp; \pi &amp; \sim &amp; \text{Gamma}(s, r) \\
  \text{likelihood: } &amp; Y|\pi &amp; \sim &amp; \text{Pois}(\lambda) \\
  \text{posterior: } &amp; \pi|Y &amp; \sim &amp; \text{Gamma}\left(s + \displaystyle\sum_{i=1}^{n} y, r + n\right) \\
\end{array}\]</span></p>
</section></section>
<section>
<section id="grid-approximation" class="title-slide slide level1 center">
<h1>Grid Approximation</h1>

</section>
<section id="broad-idea" class="slide level2">
<h2>Broad Idea</h2>
<p>As we gather pieces, the overall picture might become clear.</p>

<img data-src="ellis_rowan_puzzle_video.gif" class="r-stretch quarto-figure-center"><p class="caption">Art of Ellis Rowan</p><ul>
<li>image source: <a href="https://www.nla.gov.au/stories/news/2020/puzzles-using-collection">National Museum of Australia</a></li>
</ul>
</section>
<section id="math-definitions" class="slide level2">
<h2>Math Definitions</h2>
<p>Grid approximation produces a sample of <span class="math inline">\(N\)</span> independent <span class="math inline">\(\theta\)</span> values, <span class="math inline">\(\{\theta^(1),\theta^(2),â€¦,\theta^(N)\}\)</span>, from a discretized approximation of posterior pdf <span class="math inline">\(f(\theta|y)\)</span>. This algorithm evolves in four steps:</p>
<ol type="1">
<li><p>Define a discrete grid of possible <span class="math inline">\(\theta\)</span> values.</p></li>
<li><p>Evaluate the prior pdf <span class="math inline">\(f(\theta)\)</span> and likelihood function <span class="math inline">\(L(\theta|y)\)</span> at each <span class="math inline">\(\theta\)</span> grid value.</p></li>
<li><p>Obtain a discrete approximation of the posterior pdf <span class="math inline">\(f(\theta|y)\)</span> by:</p>
<ol type="a">
<li>calculating the product <span class="math inline">\(f(\theta)L(\theta|y)\)</span> at each <span class="math inline">\(\theta\)</span> grid value; and then</li>
<li>normalizing the products so that they sum to 1 across all <span class="math inline">\(\theta\)</span>.</li>
</ol></li>
<li><p>Randomly sample <span class="math inline">\(N\)</span> <span class="math inline">\(\theta\)</span> grid values with respect to their corresponding normalized posterior probabilities.</p></li>
</ol>
</section>
<section id="example-beta-binomial" class="slide level2">
<h2>Example: Beta-Binomial</h2>
<h3 id="scenario-smokers-in-restaurants">Scenario: Smokers in Restaurants</h3>
<p>Let us start with a vague beta prior, use a binomial model to get the likelihood of <span class="math inline">\(y = 4\)</span> smokers among <span class="math inline">\(n = 9\)</span> customers, and then get a beta posterior.</p>
<p><span class="math display">\[\begin{array}{rrcl}
  \text{prior: } &amp; \pi &amp; \sim &amp; \text{Beta}(3, 3) \\
  \text{likelihood: } &amp; Y|\pi &amp; \sim &amp; \text{Bin}(9, \pi) \\
  \text{posterior: } &amp; \pi|Y &amp; \sim &amp; \text{Beta}(7, 8) \\
\end{array}\]</span></p>
</section>
<section id="sparse-grid" class="slide level2">
<h2>Sparse Grid</h2>
<p>Here we will try this grid approximation idea over <span class="math inline">\(N = 5\)</span> values</p>
<p><span class="math display">\[\pi \in \{0, 0.25, 0.50, 0.75, 1.0\}\]</span></p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Bayes</a></li><li><a href="#tabset-1-2">Grid Data</a></li><li><a href="#tabset-1-3">Grid Values</a></li><li><a href="#tabset-1-4">Graph 1 Code</a></li><li><a href="#tabset-1-5">Posterior Sampling</a></li><li><a href="#tabset-1-6">Alignment</a></li><li><a href="#tabset-1-7">Graph 2 Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Step 1: Define a grid of 6 pi values</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>grid_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pi_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, </span>
<span id="cb1-3"><a href="#cb1-3"></a>                                      <span class="at">length =</span> <span class="dv">5</span>))</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># Step 2: Evaluate the prior &amp; likelihood at each pi</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="fu">mutate</span>(<span class="at">prior =</span> <span class="fu">dbeta</span>(pi_grid, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb1-8"><a href="#cb1-8"></a>         <span class="at">likelihood =</span> <span class="fu">dbinom</span>(<span class="dv">4</span>, <span class="dv">9</span>, pi_grid))</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Step 3: Approximate the posterior</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="fu">mutate</span>(<span class="at">unnormalized =</span> likelihood <span class="sc">*</span> prior,</span>
<span id="cb1-13"><a href="#cb1-13"></a>         <span class="at">posterior =</span> unnormalized <span class="sc">/</span> <span class="fu">sum</span>(unnormalized))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">round</span>(grid_data, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pi_grid  prior likelihood unnormalized posterior
1    0.00 0.0000     0.0000       0.0000    0.0000
2    0.25 1.0547     0.1168       0.1232    0.1969
3    0.50 1.8750     0.2461       0.4614    0.7375
4    0.75 1.0547     0.0389       0.0411    0.0656
5    1.00 0.0000     0.0000       0.0000    0.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-4-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-1-4">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Plot the grid approximated posterior</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">ggplot</span>(grid_data, <span class="fu">aes</span>(<span class="at">x =</span> pi_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span> </span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> pi_grid, <span class="at">xend =</span> pi_grid, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> posterior),</span>
<span id="cb4-4"><a href="#cb4-4"></a>               <span class="at">color =</span> <span class="st">"gray50"</span>,</span>
<span id="cb4-5"><a href="#cb4-5"></a>               <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sparse Grid"</span>,</span>
<span id="cb4-8"><a href="#cb4-8"></a>         <span class="at">subtitle =</span> <span class="st">"Beta-Binomial Example"</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a>         <span class="at">caption =</span> <span class="st">"SML 320"</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-5">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Step 4: sample from the discretized posterior</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>posterior_sample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(grid_data, </span>
<span id="cb5-3"><a href="#cb5-3"></a>                             <span class="at">size =</span> <span class="dv">10000</span>, </span>
<span id="cb5-4"><a href="#cb5-4"></a>                             <span class="at">weight =</span> posterior, </span>
<span id="cb5-5"><a href="#cb5-5"></a>                             <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-6">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-1-7">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">ggplot</span>(posterior_sample, <span class="fu">aes</span>(<span class="at">x =</span> pi_grid)) <span class="sc">+</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), </span>
<span id="cb6-3"><a href="#cb6-3"></a>                 <span class="at">binwidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>                 <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span> </span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">7</span>, <span class="dv">8</span>),</span>
<span id="cb6-6"><a href="#cb6-6"></a>                <span class="at">color =</span> <span class="st">"#E77500"</span>, <span class="at">linewidth =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">lims</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sparse Grid: &lt;span style='color:#7F7F7F'&gt;simulation&lt;/span&gt; versus &lt;span style='color:#E77500'&gt;theoretical&lt;/span&gt;"</span>,</span>
<span id="cb6-9"><a href="#cb6-9"></a>         <span class="at">subtitle =</span> <span class="st">"Beta-Binomial Example"</span>,</span>
<span id="cb6-10"><a href="#cb6-10"></a>         <span class="at">caption =</span> <span class="st">"SML 320"</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_markdown</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="dense-grid" class="slide level2">
<h2>Dense Grid</h2>
<p>Here we will try this grid approximation idea over <span class="math inline">\(N = 101\)</span> values</p>
<p><span class="math display">\[\pi \in [0,1]\]</span></p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Bayes</a></li><li><a href="#tabset-2-2">Grid Data</a></li><li><a href="#tabset-2-3">Grid Values</a></li><li><a href="#tabset-2-4">Graph 1 Code</a></li><li><a href="#tabset-2-5">Posterior Sampling</a></li><li><a href="#tabset-2-6">Alignment</a></li><li><a href="#tabset-2-7">Graph 2 Code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Step 1: Define a grid of 6 pi values</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>grid_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pi_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, </span>
<span id="cb7-3"><a href="#cb7-3"></a>                                      <span class="at">length =</span> <span class="dv">101</span>))</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># Step 2: Evaluate the prior &amp; likelihood at each pi</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">mutate</span>(<span class="at">prior =</span> <span class="fu">dbeta</span>(pi_grid, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb7-8"><a href="#cb7-8"></a>         <span class="at">likelihood =</span> <span class="fu">dbinom</span>(<span class="dv">4</span>, <span class="dv">9</span>, pi_grid))</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co"># Step 3: Approximate the posterior</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> </span>
<span id="cb7-12"><a href="#cb7-12"></a>  <span class="fu">mutate</span>(<span class="at">unnormalized =</span> likelihood <span class="sc">*</span> prior,</span>
<span id="cb7-13"><a href="#cb7-13"></a>         <span class="at">posterior =</span> unnormalized <span class="sc">/</span> <span class="fu">sum</span>(unnormalized))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">round</span>(grid_data, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    pi_grid  prior likelihood unnormalized posterior
1      0.00 0.0000     0.0000       0.0000    0.0000
2      0.01 0.0029     0.0000       0.0000    0.0000
3      0.02 0.0115     0.0000       0.0000    0.0000
4      0.03 0.0254     0.0001       0.0000    0.0000
5      0.04 0.0442     0.0003       0.0000    0.0000
6      0.05 0.0677     0.0006       0.0000    0.0000
7      0.06 0.0954     0.0012       0.0001    0.0000
8      0.07 0.1271     0.0021       0.0003    0.0000
9      0.08 0.1625     0.0034       0.0006    0.0000
10     0.09 0.2012     0.0052       0.0010    0.0001
11     0.10 0.2430     0.0074       0.0018    0.0001
12     0.11 0.2875     0.0103       0.0030    0.0002
13     0.12 0.3345     0.0138       0.0046    0.0003
14     0.13 0.3837     0.0179       0.0069    0.0004
15     0.14 0.4349     0.0228       0.0099    0.0006
16     0.15 0.4877     0.0283       0.0138    0.0009
17     0.16 0.5419     0.0345       0.0187    0.0012
18     0.17 0.5973     0.0415       0.0248    0.0016
19     0.18 0.6536     0.0490       0.0320    0.0020
20     0.19 0.7106     0.0573       0.0407    0.0026
21     0.20 0.7680     0.0661       0.0507    0.0032
22     0.21 0.8257     0.0754       0.0623    0.0040
23     0.22 0.8834     0.0852       0.0753    0.0048
24     0.23 0.9409     0.0954       0.0898    0.0057
25     0.24 0.9981     0.1060       0.1058    0.0067
26     0.25 1.0547     0.1168       0.1232    0.0078
27     0.26 1.1105     0.1278       0.1419    0.0090
28     0.27 1.1655     0.1388       0.1618    0.0103
29     0.28 1.2193     0.1499       0.1827    0.0116
30     0.29 1.2718     0.1608       0.2045    0.0130
31     0.30 1.3230     0.1715       0.2269    0.0144
32     0.31 1.3726     0.1820       0.2498    0.0159
33     0.32 1.4205     0.1921       0.2729    0.0173
34     0.33 1.4666     0.2017       0.2959    0.0188
35     0.34 1.5107     0.2109       0.3185    0.0202
36     0.35 1.5527     0.2194       0.3406    0.0216
37     0.36 1.5925     0.2272       0.3619    0.0230
38     0.37 1.6301     0.2344       0.3820    0.0243
39     0.38 1.6652     0.2407       0.4008    0.0255
40     0.39 1.6979     0.2462       0.4180    0.0266
41     0.40 1.7280     0.2508       0.4334    0.0275
42     0.41 1.7555     0.2545       0.4468    0.0284
43     0.42 1.7802     0.2573       0.4581    0.0291
44     0.43 1.8022     0.2592       0.4671    0.0297
45     0.44 1.8214     0.2601       0.4737    0.0301
46     0.45 1.8377     0.2600       0.4779    0.0304
47     0.46 1.8511     0.2590       0.4795    0.0305
48     0.47 1.8615     0.2571       0.4786    0.0304
49     0.48 1.8690     0.2543       0.4753    0.0302
50     0.49 1.8735     0.2506       0.4695    0.0298
51     0.50 1.8750     0.2461       0.4614    0.0293
52     0.51 1.8735     0.2408       0.4511    0.0287
53     0.52 1.8690     0.2347       0.4387    0.0279
54     0.53 1.8615     0.2280       0.4245    0.0270
55     0.54 1.8511     0.2207       0.4085    0.0260
56     0.55 1.8377     0.2128       0.3910    0.0248
57     0.56 1.8214     0.2044       0.3722    0.0237
58     0.57 1.8022     0.1955       0.3524    0.0224
59     0.58 1.7802     0.1863       0.3317    0.0211
60     0.59 1.7555     0.1769       0.3105    0.0197
61     0.60 1.7280     0.1672       0.2889    0.0184
62     0.61 1.6979     0.1574       0.2673    0.0170
63     0.62 1.6652     0.1475       0.2457    0.0156
64     0.63 1.6301     0.1376       0.2244    0.0143
65     0.64 1.5925     0.1278       0.2036    0.0129
66     0.65 1.5527     0.1181       0.1834    0.0117
67     0.66 1.5107     0.1086       0.1641    0.0104
68     0.67 1.4666     0.0994       0.1457    0.0093
69     0.68 1.4205     0.0904       0.1284    0.0082
70     0.69 1.3726     0.0818       0.1122    0.0071
71     0.70 1.3230     0.0735       0.0973    0.0062
72     0.71 1.2718     0.0657       0.0835    0.0053
73     0.72 1.2193     0.0583       0.0711    0.0045
74     0.73 1.1655     0.0513       0.0598    0.0038
75     0.74 1.1105     0.0449       0.0499    0.0032
76     0.75 1.0547     0.0389       0.0411    0.0026
77     0.76 0.9981     0.0335       0.0334    0.0021
78     0.77 0.9409     0.0285       0.0268    0.0017
79     0.78 0.8834     0.0240       0.0212    0.0013
80     0.79 0.8257     0.0200       0.0165    0.0011
81     0.80 0.7680     0.0165       0.0127    0.0008
82     0.81 0.7106     0.0134       0.0095    0.0006
83     0.82 0.6536     0.0108       0.0070    0.0004
84     0.83 0.5973     0.0085       0.0051    0.0003
85     0.84 0.5419     0.0066       0.0036    0.0002
86     0.85 0.4877     0.0050       0.0024    0.0002
87     0.86 0.4349     0.0037       0.0016    0.0001
88     0.87 0.3837     0.0027       0.0010    0.0001
89     0.88 0.3345     0.0019       0.0006    0.0000
90     0.89 0.2875     0.0013       0.0004    0.0000
91     0.90 0.2430     0.0008       0.0002    0.0000
92     0.91 0.2012     0.0005       0.0001    0.0000
93     0.92 0.1625     0.0003       0.0000    0.0000
94     0.93 0.1271     0.0002       0.0000    0.0000
95     0.94 0.0954     0.0001       0.0000    0.0000
96     0.95 0.0677     0.0000       0.0000    0.0000
97     0.96 0.0442     0.0000       0.0000    0.0000
98     0.97 0.0254     0.0000       0.0000    0.0000
99     0.98 0.0115     0.0000       0.0000    0.0000
100    0.99 0.0029     0.0000       0.0000    0.0000
101    1.00 0.0000     0.0000       0.0000    0.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-11-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-2-4">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Plot the grid approximated posterior</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">ggplot</span>(grid_data, <span class="fu">aes</span>(<span class="at">x =</span> pi_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> pi_grid, <span class="at">xend =</span> pi_grid, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> posterior),</span>
<span id="cb10-4"><a href="#cb10-4"></a>               <span class="at">color =</span> <span class="st">"gray50"</span>,</span>
<span id="cb10-5"><a href="#cb10-5"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dense Grid"</span>,</span>
<span id="cb10-8"><a href="#cb10-8"></a>         <span class="at">subtitle =</span> <span class="st">"Beta-Binomial Example"</span>,</span>
<span id="cb10-9"><a href="#cb10-9"></a>         <span class="at">caption =</span> <span class="st">"SML 320"</span>) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-5">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Step 4: sample from the discretized posterior</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>posterior_sample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(grid_data, </span>
<span id="cb11-3"><a href="#cb11-3"></a>                             <span class="at">size =</span> <span class="dv">10000</span>, </span>
<span id="cb11-4"><a href="#cb11-4"></a>                             <span class="at">weight =</span> posterior, </span>
<span id="cb11-5"><a href="#cb11-5"></a>                             <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-6">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-14-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-2-7">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">ggplot</span>(posterior_sample, <span class="fu">aes</span>(<span class="at">x =</span> pi_grid)) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), </span>
<span id="cb12-3"><a href="#cb12-3"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb12-4"><a href="#cb12-4"></a>                 <span class="at">binwidth =</span> <span class="fl">0.05</span>,</span>
<span id="cb12-5"><a href="#cb12-5"></a>                 <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">7</span>, <span class="dv">8</span>),</span>
<span id="cb12-7"><a href="#cb12-7"></a>                <span class="at">color =</span> <span class="st">"#E77500"</span>, <span class="at">linewidth =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="fu">lims</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dense Grid: &lt;span style='color:#7F7F7F'&gt;simulation&lt;/span&gt; versus &lt;span style='color:#E77500'&gt;theoretical&lt;/span&gt;"</span>,</span>
<span id="cb12-10"><a href="#cb12-10"></a>         <span class="at">subtitle =</span> <span class="st">"Beta-Binomial Example"</span>,</span>
<span id="cb12-11"><a href="#cb12-11"></a>         <span class="at">caption =</span> <span class="st">"SML 320"</span>) <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_markdown</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="example-gamma-poisson" class="slide level2">
<h2>Example: Gamma-Poisson</h2>
<h3 id="scenario-drug-law-violations">Scenario: Drug Law Violations</h3>
<p>Let us start with a vague Gamma prior, use a binomial model to get the likelihood of <span class="math inline">\(\sum y = 119\)</span> drug law violations over <span class="math inline">\(n = 9\)</span> years, and then get a Gamma posterior.</p>
<p><span class="math display">\[\begin{array}{rrcl}
  \text{prior: } &amp; \pi &amp; \sim &amp; \text{Gamma}(16, 0.8) \\
  \text{likelihood: } &amp; Y|\pi &amp; \sim &amp; \text{Pois}(119/9) \\
  \text{posterior: } &amp; \pi|Y &amp; \sim &amp; \text{Gamma}(135, 9.8) \\
\end{array}\]</span></p>
</section>
<section id="sparse-grid-1" class="slide level2">
<h2>Sparse Grid</h2>
<p>Here we will try this grid approximation idea over <span class="math inline">\(N = 11\)</span> values</p>
<p><span class="math display">\[\lambda \in \{0, 3, 6, 9, 12, 15, 18, 21, 24, 27, 30\}\]</span></p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Bayes</a></li><li><a href="#tabset-3-2">Grid Data</a></li><li><a href="#tabset-3-3">Grid Values</a></li><li><a href="#tabset-3-4">Graph 1 Code</a></li><li><a href="#tabset-3-5">Posterior Sampling</a></li><li><a href="#tabset-3-6">Alignment</a></li><li><a href="#tabset-3-7">Graph 2 Code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>obs_counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">14</span>, <span class="dv">23</span>, <span class="dv">22</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># Step 1: Define a grid of 11 pi values</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>grid_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lambda_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">30</span>, </span>
<span id="cb13-5"><a href="#cb13-5"></a>                                      <span class="at">length =</span> <span class="dv">11</span>))</span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co"># Step 2: Evaluate the prior &amp; likelihood at each pi</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> </span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="fu">mutate</span>(<span class="at">prior =</span> <span class="fu">dgamma</span>(lambda_grid, <span class="dv">16</span>, <span class="fl">0.8</span>),</span>
<span id="cb13-10"><a href="#cb13-10"></a>         <span class="at">likelihood =</span> <span class="fu">dpois</span>(<span class="dv">18</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>           <span class="fu">dpois</span>(<span class="dv">14</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>           <span class="fu">dpois</span>(<span class="dv">23</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>           <span class="fu">dpois</span>(<span class="dv">22</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>           <span class="fu">dpois</span>(<span class="dv">12</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>           <span class="fu">dpois</span>(<span class="dv">22</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>           <span class="fu">dpois</span>(<span class="dv">7</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>           <span class="fu">dpois</span>(<span class="dv">0</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb13-18"><a href="#cb13-18"></a>           <span class="fu">dpois</span>(<span class="dv">1</span>, lambda_grid))</span>
<span id="cb13-19"><a href="#cb13-19"></a></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co"># Step 3: Approximate the posterior</span></span>
<span id="cb13-21"><a href="#cb13-21"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> </span>
<span id="cb13-22"><a href="#cb13-22"></a>  <span class="fu">mutate</span>(<span class="at">unnormalized =</span> likelihood <span class="sc">*</span> prior,</span>
<span id="cb13-23"><a href="#cb13-23"></a>         <span class="at">posterior =</span> unnormalized <span class="sc">/</span> <span class="fu">sum</span>(unnormalized))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">round</span>(grid_data, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   lambda_grid  prior likelihood unnormalized posterior
1            0 0.0000          0            0    0.0000
2            3 0.0000          0            0    0.0000
3            6 0.0001          0            0    0.0000
4            9 0.0033          0            0    0.0000
5           12 0.0225          0            0    0.3756
6           15 0.0579          0            0    0.6200
7           18 0.0809          0            0    0.0043
8           21 0.0741          0            0    0.0000
9           24 0.0498          0            0    0.0000
10          27 0.0265          0            0    0.0000
11          30 0.0117          0            0    0.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-18-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-3-4">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Plot the grid approximated posterior</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">ggplot</span>(grid_data, <span class="fu">aes</span>(<span class="at">x =</span> lambda_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda_grid, <span class="at">xend =</span> lambda_grid, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> posterior),</span>
<span id="cb16-4"><a href="#cb16-4"></a>               <span class="at">color =</span> <span class="st">"gray50"</span>,</span>
<span id="cb16-5"><a href="#cb16-5"></a>               <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb16-7"><a href="#cb16-7"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sparse Grid"</span>,</span>
<span id="cb16-8"><a href="#cb16-8"></a>         <span class="at">subtitle =</span> <span class="st">"Gamma-Poisson Example"</span>,</span>
<span id="cb16-9"><a href="#cb16-9"></a>         <span class="at">caption =</span> <span class="st">"SML 320"</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-5">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Step 4: sample from the discretized posterior</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>posterior_sample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(grid_data, </span>
<span id="cb17-3"><a href="#cb17-3"></a>                             <span class="at">size =</span> <span class="dv">10000</span>, </span>
<span id="cb17-4"><a href="#cb17-4"></a>                             <span class="at">weight =</span> posterior, </span>
<span id="cb17-5"><a href="#cb17-5"></a>                             <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-6">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-21-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-3-7">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">ggplot</span>(posterior_sample, <span class="fu">aes</span>(<span class="at">x =</span> pi_grid)) <span class="sc">+</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), </span>
<span id="cb18-3"><a href="#cb18-3"></a>                 <span class="at">binwidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb18-4"><a href="#cb18-4"></a>                 <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span> </span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">7</span>, <span class="dv">8</span>),</span>
<span id="cb18-6"><a href="#cb18-6"></a>                <span class="at">color =</span> <span class="st">"#E77500"</span>, <span class="at">linewidth =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="fu">lims</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sparse Grid: &lt;span style='color:#7F7F7F'&gt;simulation&lt;/span&gt; versus &lt;span style='color:#E77500'&gt;theoretical&lt;/span&gt;"</span>,</span>
<span id="cb18-9"><a href="#cb18-9"></a>         <span class="at">subtitle =</span> <span class="st">"Gamma-Poisson Example"</span>,</span>
<span id="cb18-10"><a href="#cb18-10"></a>         <span class="at">caption =</span> <span class="st">"SML 320"</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_markdown</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="dense-grid-1" class="slide level2">
<h2>Dense Grid</h2>
<p>Here we will try this grid approximation idea over <span class="math inline">\(N = 501\)</span> values</p>
<p><span class="math display">\[\lambda \in [0, 30]\]</span></p>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Bayes</a></li><li><a href="#tabset-4-2">Grid Data</a></li><li><a href="#tabset-4-3">Grid Values</a></li><li><a href="#tabset-4-4">Graph 1 Code</a></li><li><a href="#tabset-4-5">Posterior Sampling</a></li><li><a href="#tabset-4-6">Alignment</a></li><li><a href="#tabset-4-7">Graph 2 Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>obs_counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">14</span>, <span class="dv">23</span>, <span class="dv">22</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co"># Step 1: Define a grid of 11 pi values</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>grid_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lambda_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">30</span>, </span>
<span id="cb19-5"><a href="#cb19-5"></a>                                      <span class="at">length =</span> <span class="dv">501</span>))</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co"># Step 2: Evaluate the prior &amp; likelihood at each pi</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9"></a>  <span class="fu">mutate</span>(<span class="at">prior =</span> <span class="fu">dgamma</span>(lambda_grid, <span class="dv">16</span>, <span class="fl">0.8</span>),</span>
<span id="cb19-10"><a href="#cb19-10"></a>         <span class="at">likelihood =</span> <span class="fu">dpois</span>(<span class="dv">18</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>           <span class="fu">dpois</span>(<span class="dv">14</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>           <span class="fu">dpois</span>(<span class="dv">23</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>           <span class="fu">dpois</span>(<span class="dv">22</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>           <span class="fu">dpois</span>(<span class="dv">12</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>           <span class="fu">dpois</span>(<span class="dv">22</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>           <span class="fu">dpois</span>(<span class="dv">7</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>           <span class="fu">dpois</span>(<span class="dv">0</span>, lambda_grid)<span class="sc">*</span></span>
<span id="cb19-18"><a href="#cb19-18"></a>           <span class="fu">dpois</span>(<span class="dv">1</span>, lambda_grid))</span>
<span id="cb19-19"><a href="#cb19-19"></a></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co"># Step 3: Approximate the posterior</span></span>
<span id="cb19-21"><a href="#cb19-21"></a>grid_data <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> </span>
<span id="cb19-22"><a href="#cb19-22"></a>  <span class="fu">mutate</span>(<span class="at">unnormalized =</span> likelihood <span class="sc">*</span> prior,</span>
<span id="cb19-23"><a href="#cb19-23"></a>         <span class="at">posterior =</span> unnormalized <span class="sc">/</span> <span class="fu">sum</span>(unnormalized))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">round</span>(grid_data, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    lambda_grid  prior likelihood unnormalized posterior
1          0.00 0.0000          0            0    0.0000
2          0.06 0.0000          0            0    0.0000
3          0.12 0.0000          0            0    0.0000
4          0.18 0.0000          0            0    0.0000
5          0.24 0.0000          0            0    0.0000
6          0.30 0.0000          0            0    0.0000
7          0.36 0.0000          0            0    0.0000
8          0.42 0.0000          0            0    0.0000
9          0.48 0.0000          0            0    0.0000
10         0.54 0.0000          0            0    0.0000
11         0.60 0.0000          0            0    0.0000
12         0.66 0.0000          0            0    0.0000
13         0.72 0.0000          0            0    0.0000
14         0.78 0.0000          0            0    0.0000
15         0.84 0.0000          0            0    0.0000
16         0.90 0.0000          0            0    0.0000
17         0.96 0.0000          0            0    0.0000
18         1.02 0.0000          0            0    0.0000
19         1.08 0.0000          0            0    0.0000
20         1.14 0.0000          0            0    0.0000
21         1.20 0.0000          0            0    0.0000
22         1.26 0.0000          0            0    0.0000
23         1.32 0.0000          0            0    0.0000
24         1.38 0.0000          0            0    0.0000
25         1.44 0.0000          0            0    0.0000
26         1.50 0.0000          0            0    0.0000
27         1.56 0.0000          0            0    0.0000
28         1.62 0.0000          0            0    0.0000
29         1.68 0.0000          0            0    0.0000
30         1.74 0.0000          0            0    0.0000
31         1.80 0.0000          0            0    0.0000
32         1.86 0.0000          0            0    0.0000
33         1.92 0.0000          0            0    0.0000
34         1.98 0.0000          0            0    0.0000
35         2.04 0.0000          0            0    0.0000
36         2.10 0.0000          0            0    0.0000
37         2.16 0.0000          0            0    0.0000
38         2.22 0.0000          0            0    0.0000
39         2.28 0.0000          0            0    0.0000
40         2.34 0.0000          0            0    0.0000
41         2.40 0.0000          0            0    0.0000
42         2.46 0.0000          0            0    0.0000
43         2.52 0.0000          0            0    0.0000
44         2.58 0.0000          0            0    0.0000
45         2.64 0.0000          0            0    0.0000
46         2.70 0.0000          0            0    0.0000
47         2.76 0.0000          0            0    0.0000
48         2.82 0.0000          0            0    0.0000
49         2.88 0.0000          0            0    0.0000
50         2.94 0.0000          0            0    0.0000
51         3.00 0.0000          0            0    0.0000
52         3.06 0.0000          0            0    0.0000
53         3.12 0.0000          0            0    0.0000
54         3.18 0.0000          0            0    0.0000
55         3.24 0.0000          0            0    0.0000
56         3.30 0.0000          0            0    0.0000
57         3.36 0.0000          0            0    0.0000
58         3.42 0.0000          0            0    0.0000
59         3.48 0.0000          0            0    0.0000
60         3.54 0.0000          0            0    0.0000
61         3.60 0.0000          0            0    0.0000
62         3.66 0.0000          0            0    0.0000
63         3.72 0.0000          0            0    0.0000
64         3.78 0.0000          0            0    0.0000
65         3.84 0.0000          0            0    0.0000
66         3.90 0.0000          0            0    0.0000
67         3.96 0.0000          0            0    0.0000
68         4.02 0.0000          0            0    0.0000
69         4.08 0.0000          0            0    0.0000
70         4.14 0.0000          0            0    0.0000
71         4.20 0.0000          0            0    0.0000
72         4.26 0.0000          0            0    0.0000
73         4.32 0.0000          0            0    0.0000
74         4.38 0.0000          0            0    0.0000
75         4.44 0.0000          0            0    0.0000
76         4.50 0.0000          0            0    0.0000
77         4.56 0.0000          0            0    0.0000
78         4.62 0.0000          0            0    0.0000
79         4.68 0.0000          0            0    0.0000
80         4.74 0.0000          0            0    0.0000
81         4.80 0.0000          0            0    0.0000
82         4.86 0.0000          0            0    0.0000
83         4.92 0.0000          0            0    0.0000
84         4.98 0.0000          0            0    0.0000
85         5.04 0.0000          0            0    0.0000
86         5.10 0.0000          0            0    0.0000
87         5.16 0.0000          0            0    0.0000
88         5.22 0.0000          0            0    0.0000
89         5.28 0.0000          0            0    0.0000
90         5.34 0.0000          0            0    0.0000
91         5.40 0.0000          0            0    0.0000
92         5.46 0.0000          0            0    0.0000
93         5.52 0.0000          0            0    0.0000
94         5.58 0.0000          0            0    0.0000
95         5.64 0.0000          0            0    0.0000
96         5.70 0.0000          0            0    0.0000
97         5.76 0.0001          0            0    0.0000
98         5.82 0.0001          0            0    0.0000
99         5.88 0.0001          0            0    0.0000
100        5.94 0.0001          0            0    0.0000
101        6.00 0.0001          0            0    0.0000
102        6.06 0.0001          0            0    0.0000
103        6.12 0.0001          0            0    0.0000
104        6.18 0.0001          0            0    0.0000
105        6.24 0.0001          0            0    0.0000
106        6.30 0.0001          0            0    0.0000
107        6.36 0.0001          0            0    0.0000
108        6.42 0.0002          0            0    0.0000
109        6.48 0.0002          0            0    0.0000
110        6.54 0.0002          0            0    0.0000
111        6.60 0.0002          0            0    0.0000
112        6.66 0.0002          0            0    0.0000
113        6.72 0.0003          0            0    0.0000
114        6.78 0.0003          0            0    0.0000
115        6.84 0.0003          0            0    0.0000
116        6.90 0.0003          0            0    0.0000
117        6.96 0.0004          0            0    0.0000
118        7.02 0.0004          0            0    0.0000
119        7.08 0.0004          0            0    0.0000
120        7.14 0.0005          0            0    0.0000
121        7.20 0.0005          0            0    0.0000
122        7.26 0.0005          0            0    0.0000
123        7.32 0.0006          0            0    0.0000
124        7.38 0.0006          0            0    0.0000
125        7.44 0.0007          0            0    0.0000
126        7.50 0.0007          0            0    0.0000
127        7.56 0.0008          0            0    0.0000
128        7.62 0.0008          0            0    0.0000
129        7.68 0.0009          0            0    0.0000
130        7.74 0.0009          0            0    0.0000
131        7.80 0.0010          0            0    0.0000
132        7.86 0.0011          0            0    0.0000
133        7.92 0.0012          0            0    0.0000
134        7.98 0.0012          0            0    0.0000
135        8.04 0.0013          0            0    0.0000
136        8.10 0.0014          0            0    0.0000
137        8.16 0.0015          0            0    0.0000
138        8.22 0.0016          0            0    0.0000
139        8.28 0.0017          0            0    0.0000
140        8.34 0.0018          0            0    0.0000
141        8.40 0.0019          0            0    0.0000
142        8.46 0.0020          0            0    0.0000
143        8.52 0.0021          0            0    0.0000
144        8.58 0.0023          0            0    0.0000
145        8.64 0.0024          0            0    0.0000
146        8.70 0.0025          0            0    0.0000
147        8.76 0.0027          0            0    0.0000
148        8.82 0.0028          0            0    0.0000
149        8.88 0.0030          0            0    0.0000
150        8.94 0.0031          0            0    0.0000
151        9.00 0.0033          0            0    0.0000
152        9.06 0.0035          0            0    0.0000
153        9.12 0.0037          0            0    0.0000
154        9.18 0.0039          0            0    0.0000
155        9.24 0.0041          0            0    0.0000
156        9.30 0.0043          0            0    0.0000
157        9.36 0.0045          0            0    0.0000
158        9.42 0.0047          0            0    0.0000
159        9.48 0.0049          0            0    0.0000
160        9.54 0.0051          0            0    0.0000
161        9.60 0.0054          0            0    0.0000
162        9.66 0.0056          0            0    0.0000
163        9.72 0.0059          0            0    0.0000
164        9.78 0.0062          0            0    0.0000
165        9.84 0.0064          0            0    0.0000
166        9.90 0.0067          0            0    0.0000
167        9.96 0.0070          0            0    0.0000
168       10.02 0.0073          0            0    0.0001
169       10.08 0.0076          0            0    0.0001
170       10.14 0.0080          0            0    0.0001
171       10.20 0.0083          0            0    0.0001
172       10.26 0.0086          0            0    0.0001
173       10.32 0.0090          0            0    0.0002
174       10.38 0.0093          0            0    0.0002
175       10.44 0.0097          0            0    0.0002
176       10.50 0.0101          0            0    0.0003
177       10.56 0.0104          0            0    0.0003
178       10.62 0.0108          0            0    0.0004
179       10.68 0.0112          0            0    0.0005
180       10.74 0.0117          0            0    0.0005
181       10.80 0.0121          0            0    0.0006
182       10.86 0.0125          0            0    0.0007
183       10.92 0.0130          0            0    0.0009
184       10.98 0.0134          0            0    0.0010
185       11.04 0.0139          0            0    0.0012
186       11.10 0.0143          0            0    0.0013
187       11.16 0.0148          0            0    0.0015
188       11.22 0.0153          0            0    0.0017
189       11.28 0.0158          0            0    0.0020
190       11.34 0.0163          0            0    0.0022
191       11.40 0.0168          0            0    0.0025
192       11.46 0.0173          0            0    0.0028
193       11.52 0.0179          0            0    0.0032
194       11.58 0.0184          0            0    0.0035
195       11.64 0.0190          0            0    0.0039
196       11.70 0.0195          0            0    0.0043
197       11.76 0.0201          0            0    0.0048
198       11.82 0.0207          0            0    0.0052
199       11.88 0.0213          0            0    0.0057
200       11.94 0.0219          0            0    0.0062
201       12.00 0.0225          0            0    0.0068
202       12.06 0.0231          0            0    0.0074
203       12.12 0.0237          0            0    0.0079
204       12.18 0.0243          0            0    0.0085
205       12.24 0.0249          0            0    0.0092
206       12.30 0.0256          0            0    0.0098
207       12.36 0.0262          0            0    0.0105
208       12.42 0.0269          0            0    0.0111
209       12.48 0.0276          0            0    0.0118
210       12.54 0.0282          0            0    0.0124
211       12.60 0.0289          0            0    0.0131
212       12.66 0.0296          0            0    0.0137
213       12.72 0.0303          0            0    0.0144
214       12.78 0.0310          0            0    0.0150
215       12.84 0.0316          0            0    0.0156
216       12.90 0.0323          0            0    0.0162
217       12.96 0.0331          0            0    0.0168
218       13.02 0.0338          0            0    0.0173
219       13.08 0.0345          0            0    0.0178
220       13.14 0.0352          0            0    0.0182
221       13.20 0.0359          0            0    0.0187
222       13.26 0.0367          0            0    0.0190
223       13.32 0.0374          0            0    0.0193
224       13.38 0.0381          0            0    0.0196
225       13.44 0.0389          0            0    0.0199
226       13.50 0.0396          0            0    0.0200
227       13.56 0.0403          0            0    0.0202
228       13.62 0.0411          0            0    0.0202
229       13.68 0.0418          0            0    0.0203
230       13.74 0.0426          0            0    0.0202
231       13.80 0.0433          0            0    0.0201
232       13.86 0.0440          0            0    0.0200
233       13.92 0.0448          0            0    0.0198
234       13.98 0.0455          0            0    0.0196
235       14.04 0.0463          0            0    0.0193
236       14.10 0.0470          0            0    0.0190
237       14.16 0.0478          0            0    0.0186
238       14.22 0.0485          0            0    0.0182
239       14.28 0.0493          0            0    0.0178
240       14.34 0.0500          0            0    0.0174
241       14.40 0.0507          0            0    0.0169
242       14.46 0.0515          0            0    0.0164
243       14.52 0.0522          0            0    0.0158
244       14.58 0.0529          0            0    0.0153
245       14.64 0.0537          0            0    0.0147
246       14.70 0.0544          0            0    0.0141
247       14.76 0.0551          0            0    0.0135
248       14.82 0.0558          0            0    0.0130
249       14.88 0.0565          0            0    0.0124
250       14.94 0.0572          0            0    0.0118
251       15.00 0.0579          0            0    0.0112
252       15.06 0.0586          0            0    0.0106
253       15.12 0.0593          0            0    0.0100
254       15.18 0.0600          0            0    0.0095
255       15.24 0.0606          0            0    0.0089
256       15.30 0.0613          0            0    0.0084
257       15.36 0.0620          0            0    0.0079
258       15.42 0.0626          0            0    0.0074
259       15.48 0.0633          0            0    0.0069
260       15.54 0.0639          0            0    0.0064
261       15.60 0.0645          0            0    0.0060
262       15.66 0.0652          0            0    0.0056
263       15.72 0.0658          0            0    0.0052
264       15.78 0.0664          0            0    0.0048
265       15.84 0.0670          0            0    0.0044
266       15.90 0.0676          0            0    0.0041
267       15.96 0.0681          0            0    0.0037
268       16.02 0.0687          0            0    0.0034
269       16.08 0.0693          0            0    0.0032
270       16.14 0.0698          0            0    0.0029
271       16.20 0.0703          0            0    0.0026
272       16.26 0.0709          0            0    0.0024
273       16.32 0.0714          0            0    0.0022
274       16.38 0.0719          0            0    0.0020
275       16.44 0.0724          0            0    0.0018
276       16.50 0.0729          0            0    0.0016
277       16.56 0.0733          0            0    0.0015
278       16.62 0.0738          0            0    0.0013
279       16.68 0.0742          0            0    0.0012
280       16.74 0.0747          0            0    0.0011
281       16.80 0.0751          0            0    0.0010
282       16.86 0.0755          0            0    0.0009
283       16.92 0.0759          0            0    0.0008
284       16.98 0.0763          0            0    0.0007
285       17.04 0.0767          0            0    0.0006
286       17.10 0.0770          0            0    0.0005
287       17.16 0.0774          0            0    0.0005
288       17.22 0.0777          0            0    0.0004
289       17.28 0.0781          0            0    0.0004
290       17.34 0.0784          0            0    0.0003
291       17.40 0.0787          0            0    0.0003
292       17.46 0.0790          0            0    0.0003
293       17.52 0.0792          0            0    0.0002
294       17.58 0.0795          0            0    0.0002
295       17.64 0.0797          0            0    0.0002
296       17.70 0.0800          0            0    0.0002
297       17.76 0.0802          0            0    0.0001
298       17.82 0.0804          0            0    0.0001
299       17.88 0.0806          0            0    0.0001
300       17.94 0.0808          0            0    0.0001
301       18.00 0.0809          0            0    0.0001
302       18.06 0.0811          0            0    0.0001
303       18.12 0.0812          0            0    0.0001
304       18.18 0.0814          0            0    0.0001
305       18.24 0.0815          0            0    0.0000
306       18.30 0.0816          0            0    0.0000
307       18.36 0.0817          0            0    0.0000
308       18.42 0.0818          0            0    0.0000
309       18.48 0.0818          0            0    0.0000
310       18.54 0.0819          0            0    0.0000
311       18.60 0.0819          0            0    0.0000
312       18.66 0.0819          0            0    0.0000
313       18.72 0.0819          0            0    0.0000
314       18.78 0.0819          0            0    0.0000
315       18.84 0.0819          0            0    0.0000
316       18.90 0.0819          0            0    0.0000
317       18.96 0.0819          0            0    0.0000
318       19.02 0.0818          0            0    0.0000
319       19.08 0.0818          0            0    0.0000
320       19.14 0.0817          0            0    0.0000
321       19.20 0.0816          0            0    0.0000
322       19.26 0.0815          0            0    0.0000
323       19.32 0.0814          0            0    0.0000
324       19.38 0.0813          0            0    0.0000
325       19.44 0.0811          0            0    0.0000
326       19.50 0.0810          0            0    0.0000
327       19.56 0.0808          0            0    0.0000
328       19.62 0.0807          0            0    0.0000
329       19.68 0.0805          0            0    0.0000
330       19.74 0.0803          0            0    0.0000
331       19.80 0.0801          0            0    0.0000
332       19.86 0.0799          0            0    0.0000
333       19.92 0.0797          0            0    0.0000
334       19.98 0.0795          0            0    0.0000
335       20.04 0.0792          0            0    0.0000
336       20.10 0.0790          0            0    0.0000
337       20.16 0.0787          0            0    0.0000
338       20.22 0.0784          0            0    0.0000
339       20.28 0.0782          0            0    0.0000
340       20.34 0.0779          0            0    0.0000
341       20.40 0.0776          0            0    0.0000
342       20.46 0.0773          0            0    0.0000
343       20.52 0.0770          0            0    0.0000
344       20.58 0.0766          0            0    0.0000
345       20.64 0.0763          0            0    0.0000
346       20.70 0.0760          0            0    0.0000
347       20.76 0.0756          0            0    0.0000
348       20.82 0.0753          0            0    0.0000
349       20.88 0.0749          0            0    0.0000
350       20.94 0.0745          0            0    0.0000
351       21.00 0.0741          0            0    0.0000
352       21.06 0.0738          0            0    0.0000
353       21.12 0.0734          0            0    0.0000
354       21.18 0.0730          0            0    0.0000
355       21.24 0.0726          0            0    0.0000
356       21.30 0.0722          0            0    0.0000
357       21.36 0.0717          0            0    0.0000
358       21.42 0.0713          0            0    0.0000
359       21.48 0.0709          0            0    0.0000
360       21.54 0.0704          0            0    0.0000
361       21.60 0.0700          0            0    0.0000
362       21.66 0.0696          0            0    0.0000
363       21.72 0.0691          0            0    0.0000
364       21.78 0.0687          0            0    0.0000
365       21.84 0.0682          0            0    0.0000
366       21.90 0.0677          0            0    0.0000
367       21.96 0.0673          0            0    0.0000
368       22.02 0.0668          0            0    0.0000
369       22.08 0.0663          0            0    0.0000
370       22.14 0.0658          0            0    0.0000
371       22.20 0.0653          0            0    0.0000
372       22.26 0.0648          0            0    0.0000
373       22.32 0.0644          0            0    0.0000
374       22.38 0.0639          0            0    0.0000
375       22.44 0.0634          0            0    0.0000
376       22.50 0.0629          0            0    0.0000
377       22.56 0.0624          0            0    0.0000
378       22.62 0.0618          0            0    0.0000
379       22.68 0.0613          0            0    0.0000
380       22.74 0.0608          0            0    0.0000
381       22.80 0.0603          0            0    0.0000
382       22.86 0.0598          0            0    0.0000
383       22.92 0.0593          0            0    0.0000
384       22.98 0.0588          0            0    0.0000
385       23.04 0.0582          0            0    0.0000
386       23.10 0.0577          0            0    0.0000
387       23.16 0.0572          0            0    0.0000
388       23.22 0.0567          0            0    0.0000
389       23.28 0.0562          0            0    0.0000
390       23.34 0.0556          0            0    0.0000
391       23.40 0.0551          0            0    0.0000
392       23.46 0.0546          0            0    0.0000
393       23.52 0.0541          0            0    0.0000
394       23.58 0.0535          0            0    0.0000
395       23.64 0.0530          0            0    0.0000
396       23.70 0.0525          0            0    0.0000
397       23.76 0.0519          0            0    0.0000
398       23.82 0.0514          0            0    0.0000
399       23.88 0.0509          0            0    0.0000
400       23.94 0.0504          0            0    0.0000
401       24.00 0.0498          0            0    0.0000
402       24.06 0.0493          0            0    0.0000
403       24.12 0.0488          0            0    0.0000
404       24.18 0.0483          0            0    0.0000
405       24.24 0.0478          0            0    0.0000
406       24.30 0.0472          0            0    0.0000
407       24.36 0.0467          0            0    0.0000
408       24.42 0.0462          0            0    0.0000
409       24.48 0.0457          0            0    0.0000
410       24.54 0.0452          0            0    0.0000
411       24.60 0.0447          0            0    0.0000
412       24.66 0.0442          0            0    0.0000
413       24.72 0.0437          0            0    0.0000
414       24.78 0.0432          0            0    0.0000
415       24.84 0.0426          0            0    0.0000
416       24.90 0.0421          0            0    0.0000
417       24.96 0.0417          0            0    0.0000
418       25.02 0.0412          0            0    0.0000
419       25.08 0.0407          0            0    0.0000
420       25.14 0.0402          0            0    0.0000
421       25.20 0.0397          0            0    0.0000
422       25.26 0.0392          0            0    0.0000
423       25.32 0.0387          0            0    0.0000
424       25.38 0.0382          0            0    0.0000
425       25.44 0.0378          0            0    0.0000
426       25.50 0.0373          0            0    0.0000
427       25.56 0.0368          0            0    0.0000
428       25.62 0.0363          0            0    0.0000
429       25.68 0.0359          0            0    0.0000
430       25.74 0.0354          0            0    0.0000
431       25.80 0.0349          0            0    0.0000
432       25.86 0.0345          0            0    0.0000
433       25.92 0.0340          0            0    0.0000
434       25.98 0.0336          0            0    0.0000
435       26.04 0.0331          0            0    0.0000
436       26.10 0.0327          0            0    0.0000
437       26.16 0.0323          0            0    0.0000
438       26.22 0.0318          0            0    0.0000
439       26.28 0.0314          0            0    0.0000
440       26.34 0.0310          0            0    0.0000
441       26.40 0.0305          0            0    0.0000
442       26.46 0.0301          0            0    0.0000
443       26.52 0.0297          0            0    0.0000
444       26.58 0.0293          0            0    0.0000
445       26.64 0.0289          0            0    0.0000
446       26.70 0.0284          0            0    0.0000
447       26.76 0.0280          0            0    0.0000
448       26.82 0.0276          0            0    0.0000
449       26.88 0.0272          0            0    0.0000
450       26.94 0.0269          0            0    0.0000
451       27.00 0.0265          0            0    0.0000
452       27.06 0.0261          0            0    0.0000
453       27.12 0.0257          0            0    0.0000
454       27.18 0.0253          0            0    0.0000
455       27.24 0.0249          0            0    0.0000
456       27.30 0.0246          0            0    0.0000
457       27.36 0.0242          0            0    0.0000
458       27.42 0.0238          0            0    0.0000
459       27.48 0.0235          0            0    0.0000
460       27.54 0.0231          0            0    0.0000
461       27.60 0.0228          0            0    0.0000
462       27.66 0.0224          0            0    0.0000
463       27.72 0.0221          0            0    0.0000
464       27.78 0.0217          0            0    0.0000
465       27.84 0.0214          0            0    0.0000
466       27.90 0.0211          0            0    0.0000
467       27.96 0.0207          0            0    0.0000
468       28.02 0.0204          0            0    0.0000
469       28.08 0.0201          0            0    0.0000
470       28.14 0.0198          0            0    0.0000
471       28.20 0.0195          0            0    0.0000
472       28.26 0.0191          0            0    0.0000
473       28.32 0.0188          0            0    0.0000
474       28.38 0.0185          0            0    0.0000
475       28.44 0.0182          0            0    0.0000
476       28.50 0.0179          0            0    0.0000
477       28.56 0.0176          0            0    0.0000
478       28.62 0.0174          0            0    0.0000
479       28.68 0.0171          0            0    0.0000
480       28.74 0.0168          0            0    0.0000
481       28.80 0.0165          0            0    0.0000
482       28.86 0.0162          0            0    0.0000
483       28.92 0.0160          0            0    0.0000
484       28.98 0.0157          0            0    0.0000
485       29.04 0.0154          0            0    0.0000
486       29.10 0.0152          0            0    0.0000
487       29.16 0.0149          0            0    0.0000
488       29.22 0.0147          0            0    0.0000
489       29.28 0.0144          0            0    0.0000
490       29.34 0.0142          0            0    0.0000
491       29.40 0.0139          0            0    0.0000
492       29.46 0.0137          0            0    0.0000
493       29.52 0.0134          0            0    0.0000
494       29.58 0.0132          0            0    0.0000
495       29.64 0.0130          0            0    0.0000
496       29.70 0.0127          0            0    0.0000
497       29.76 0.0125          0            0    0.0000
498       29.82 0.0123          0            0    0.0000
499       29.88 0.0121          0            0    0.0000
500       29.94 0.0119          0            0    0.0000
501       30.00 0.0117          0            0    0.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-25-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-4-4">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Plot the grid approximated posterior</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="fu">ggplot</span>(grid_data, <span class="fu">aes</span>(<span class="at">x =</span> lambda_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda_grid, <span class="at">xend =</span> lambda_grid, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> posterior),</span>
<span id="cb22-4"><a href="#cb22-4"></a>               <span class="at">color =</span> <span class="st">"gray50"</span>,</span>
<span id="cb22-5"><a href="#cb22-5"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb22-7"><a href="#cb22-7"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dense Grid"</span>,</span>
<span id="cb22-8"><a href="#cb22-8"></a>         <span class="at">subtitle =</span> <span class="st">"Gamma-Poisson Example"</span>,</span>
<span id="cb22-9"><a href="#cb22-9"></a>         <span class="at">caption =</span> <span class="st">"SML 320"</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-5">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Step 4: sample from the discretized posterior</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>posterior_sample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(grid_data, </span>
<span id="cb23-3"><a href="#cb23-3"></a>                             <span class="at">size =</span> <span class="dv">10000</span>, </span>
<span id="cb23-4"><a href="#cb23-4"></a>                             <span class="at">weight =</span> posterior, </span>
<span id="cb23-5"><a href="#cb23-5"></a>                             <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-6">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-28-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-4-7">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">ggplot</span>(posterior_sample, <span class="fu">aes</span>(<span class="at">x =</span> pi_grid)) <span class="sc">+</span> </span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), </span>
<span id="cb24-3"><a href="#cb24-3"></a>                 <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb24-4"><a href="#cb24-4"></a>                 <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb24-5"><a href="#cb24-5"></a>                 <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span> </span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">135</span>, <span class="fl">9.8</span>),</span>
<span id="cb24-7"><a href="#cb24-7"></a>                <span class="at">color =</span> <span class="st">"#E77500"</span>, <span class="at">linewidth =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb24-8"><a href="#cb24-8"></a>  <span class="fu">lims</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dense Grid: &lt;span style='color:#7F7F7F'&gt;simulation&lt;/span&gt; versus &lt;span style='color:#E77500'&gt;theoretical&lt;/span&gt;"</span>,</span>
<span id="cb24-10"><a href="#cb24-10"></a>         <span class="at">subtitle =</span> <span class="st">"Gamma-Poisson Example"</span>,</span>
<span id="cb24-11"><a href="#cb24-11"></a>         <span class="at">caption =</span> <span class="st">"SML 320"</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_markdown</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="limitations" class="slide level2">
<h2>Limitations</h2>
<ul>
<li>Handling larger data sets</li>
<li>Handling multiple parameters</li>
</ul>
<p><span class="math display">\[\vec{\theta} = (\theta_{1}, \theta_{2}, ..., \theta_{k})\]</span></p>
<ul>
<li><p><a href="https://en.wikipedia.org/wiki/Curse_of_dimensionality">Curse of dimensionality</a>: As the number of variables increases, â€œthe volume of the space increases so fast that the available data become sparse. In order to obtain a reliable result, the amount of data needed often grows exponentially with the dimensionalityâ€ â€” Wikipedia</p>
<ul>
<li>Beta-Binomial example: <span class="math inline">\(N = 101\)</span> grid points</li>
<li>Gamma-Poisson example: <span class="math inline">\(N = 501\)</span> grid points</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="mcmc" class="title-slide slide level1 center">
<h1>MCMC</h1>

</section>
<section id="andrey-markov" class="slide level2">
<h2>Andrey Markov</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>1868 - 1908</li>
<li>Russian Mathematician</li>
<li>known for stochastic processes</li>
<li>thesis supervisor of Georgy Voronoi</li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Andrey_Markov.png"></p>
<figcaption>Andrey Markov</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="stanislaw-ulam" class="slide level2">
<h2>Stanislaw Ulam</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>1909 - 1984</li>
<li>Polish Mathematician</li>
<li>known for Monte Carlo methods</li>
<li>indefinite appointment at <a href="https://www.ias.edu/ideas/adventures-mathematician">IAS</a></li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Neumann_Feynman_Ulam.png"></p>
<figcaption>John von Neumann, Richard Feynman, and Stanislaw Ulam, at Bandelier National Monument near Los Alamos, 1949</figcaption>
</figure>
</div>
<ul>
<li>image source: Institute for Advanced Study</li>
</ul>
</div>
</div>
</section>
<section id="mcmc-chains" class="slide level2">
<h2>MCMC Chains</h2>
<p>Let <span class="math inline">\(\{ \theta^{(1)}, \theta^{(2)}, ..., \theta^{(N)} \}\)</span> be an <strong>MCMC chain (Markov Chain Monte Carlo)</strong>.</p>
<ul>
<li><strong>Markov Property</strong>:</li>
</ul>
<p><span class="math display">\[f\left( \theta^{(i+1)} \bigg| \theta^{(1)}, \theta^{(2)}, ..., \theta^{(i)}, y \right) = f\left( \theta^{(i+1)} \bigg| \theta^{(i)}, y \right)\]</span></p>
<ul>
<li>MCMC simulation produces a chain of <span class="math inline">\(N\)</span> dependent values</li>
<li>These values are not drawn from the posterior pdf <span class="math inline">\(f(\theta|y)\)</span></li>
</ul>
</section>
<section id="stan" class="slide level2">
<h2>Stan</h2>
</section>
<section id="example-beta-binomial-1" class="slide level2">
<h2>Example: Beta-Binomial</h2>
<h3 id="scenario-smokers-in-restaurants-1">Scenario: Smokers in Restaurants</h3>
<p>Let us start with a vague beta prior, use a binomial model to get the likelihood of <span class="math inline">\(y = 4\)</span> smokers among <span class="math inline">\(n = 9\)</span> customers, and then get a beta posterior.</p>
<p><span class="math display">\[\begin{array}{rrcl}
  \text{prior: } &amp; \pi &amp; \sim &amp; \text{Beta}(3, 3) \\
  \text{likelihood: } &amp; Y|\pi &amp; \sim &amp; \text{Bin}(9, \pi) \\
  \text{posterior: } &amp; \pi|Y &amp; \sim &amp; \text{Beta}(7, 8) \\
\end{array}\]</span></p>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Define Model</a></li><li><a href="#tabset-5-2">Simulate Posterior</a></li><li><a href="#tabset-5-3">Histogram</a></li><li><a href="#tabset-5-4">Density</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># STEP 1: DEFINE the model</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>bb_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="st">  data {</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="st">    int&lt;lower = 0, upper = 9&gt; Y;</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="st">  }</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="st">  parameters {</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="st">    real&lt;lower = 0, upper = 1&gt; pi;</span></span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="st">  }</span></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="st">  model {</span></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="st">    Y ~ binomial(9, pi);</span></span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="st">    pi ~ beta(2, 2);</span></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="st">  }</span></span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co"># STEP 2: SIMULATE the posterior</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>bb_sim <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">model_code =</span> bb_model, <span class="at">data =</span> <span class="fu">list</span>(<span class="at">Y =</span> <span class="dv">4</span>), </span>
<span id="cb26-5"><a href="#cb26-5"></a>               <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">5000</span><span class="sc">*</span><span class="dv">2</span>, <span class="at">seed =</span> <span class="dv">84735</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.1 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 1: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 1: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 1: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 1: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 1: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 1: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 1: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 1: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 1: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 1: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 1: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.029 seconds (Warm-up)
Chain 1:                0.032 seconds (Sampling)
Chain 1:                0.061 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 1e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.01 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 2: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 2: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 2: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 2: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 2: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 2: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 2: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 2: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 2: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 2: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 2: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.03 seconds (Warm-up)
Chain 2:                0.032 seconds (Sampling)
Chain 2:                0.062 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 1e-06 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.01 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 3: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 3: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 3: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 3: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 3: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 3: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 3: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 3: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 3: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 3: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 3: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.029 seconds (Warm-up)
Chain 3:                0.032 seconds (Sampling)
Chain 3:                0.061 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 2e-06 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.02 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 4: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 4: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 4: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 4: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 4: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 4: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 4: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 4: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 4: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 4: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 4: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.03 seconds (Warm-up)
Chain 4:                0.032 seconds (Sampling)
Chain 4:                0.062 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">print</span>(<span class="fu">round</span>(end_time<span class="sc">-</span> start_time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 55 secs</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_hist</span>(bb_sim, <span class="at">pars =</span> <span class="st">"pi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-32-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-5-4">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens</span>(bb_sim, <span class="at">pars =</span> <span class="st">"pi"</span>) <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dbeta, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">7</span>, <span class="dv">8</span>),</span>
<span id="cb31-3"><a href="#cb31-3"></a>                <span class="at">color =</span> <span class="st">"#E77500"</span>, <span class="at">linewidth =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MCMC: &lt;span style='color:#619CFF'&gt;simulation&lt;/span&gt; versus &lt;span style='color:#E77500'&gt;theoretical&lt;/span&gt;"</span>,</span>
<span id="cb31-5"><a href="#cb31-5"></a>         <span class="at">subtitle =</span> <span class="st">"Beta-Binomial Example"</span>,</span>
<span id="cb31-6"><a href="#cb31-6"></a>         <span class="at">caption =</span> <span class="st">"SML 320"</span>) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_markdown</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-33-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="example-gamma-poisson-1" class="slide level2">
<h2>Example: Gamma-Poisson</h2>
<h3 id="scenario-drug-law-violations-1">Scenario: Drug Law Violations</h3>
<p>Let us start with a vague Gamma prior, use a binomial model to get the likelihood of <span class="math inline">\(\sum y = 119\)</span> drug law violations over <span class="math inline">\(n = 9\)</span> years, and then get a Gamma posterior.</p>
<p><span class="math display">\[\begin{array}{rrcl}
  \text{prior: } &amp; \pi &amp; \sim &amp; \text{Gamma}(16, 0.8) \\
  \text{likelihood: } &amp; Y|\pi &amp; \sim &amp; \text{Pois}(119/9) \\
  \text{posterior: } &amp; \pi|Y &amp; \sim &amp; \text{Gamma}(135, 9.8) \\
\end{array}\]</span></p>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">Define Model</a></li><li><a href="#tabset-6-2">Simulate Posterior</a></li><li><a href="#tabset-6-3">Histogram</a></li><li><a href="#tabset-6-4">Density</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># STEP 1: DEFINE the model</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>gp_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">  data {</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="st">    int&lt;lower = 0&gt; Y[9];</span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="st">  }</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="st">  parameters {</span></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="st">    real&lt;lower = 0&gt; lambda;</span></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="st">  }</span></span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="st">  model {</span></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="st">    Y ~ poisson(lambda);</span></span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="st">    lambda ~ gamma(16, 0.8);</span></span>
<span id="cb32-12"><a href="#cb32-12"></a><span class="st">  }</span></span>
<span id="cb32-13"><a href="#cb32-13"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb33-2"><a href="#cb33-2"></a></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="co"># STEP 2: SIMULATE the posterior</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>obs_counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">14</span>, <span class="dv">23</span>, <span class="dv">22</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb33-5"><a href="#cb33-5"></a>gp_sim <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">model_code =</span> gp_model, </span>
<span id="cb33-6"><a href="#cb33-6"></a>               <span class="at">data =</span> <span class="fu">list</span>(<span class="at">Y =</span> obs_counts), </span>
<span id="cb33-7"><a href="#cb33-7"></a>               <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">5000</span><span class="sc">*</span><span class="dv">2</span>, <span class="at">seed =</span> <span class="dv">84735</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1.3e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 1: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 1: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 1: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 1: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 1: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 1: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 1: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 1: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 1: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 1: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 1: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.034 seconds (Warm-up)
Chain 1:                0.034 seconds (Sampling)
Chain 1:                0.068 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 2e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.02 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 2: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 2: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 2: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 2: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 2: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 2: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 2: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 2: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 2: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 2: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 2: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.038 seconds (Warm-up)
Chain 2:                0.031 seconds (Sampling)
Chain 2:                0.069 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 2e-06 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.02 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 3: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 3: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 3: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 3: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 3: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 3: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 3: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 3: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 3: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 3: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 3: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.035 seconds (Warm-up)
Chain 3:                0.037 seconds (Sampling)
Chain 3:                0.072 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 3e-06 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.03 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 4: Iteration: 1000 / 10000 [ 10%]  (Warmup)
Chain 4: Iteration: 2000 / 10000 [ 20%]  (Warmup)
Chain 4: Iteration: 3000 / 10000 [ 30%]  (Warmup)
Chain 4: Iteration: 4000 / 10000 [ 40%]  (Warmup)
Chain 4: Iteration: 5000 / 10000 [ 50%]  (Warmup)
Chain 4: Iteration: 5001 / 10000 [ 50%]  (Sampling)
Chain 4: Iteration: 6000 / 10000 [ 60%]  (Sampling)
Chain 4: Iteration: 7000 / 10000 [ 70%]  (Sampling)
Chain 4: Iteration: 8000 / 10000 [ 80%]  (Sampling)
Chain 4: Iteration: 9000 / 10000 [ 90%]  (Sampling)
Chain 4: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.035 seconds (Warm-up)
Chain 4:                0.029 seconds (Sampling)
Chain 4:                0.064 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="fu">print</span>(<span class="fu">round</span>(end_time<span class="sc">-</span> start_time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 36 secs</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_hist</span>(gp_sim, <span class="at">pars =</span> <span class="st">"lambda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-36-1.png" width="960"></p>
</div>
</div>
</div>
<div id="tabset-6-4">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens</span>(gp_sim, <span class="at">pars =</span> <span class="st">"lambda"</span>) <span class="sc">+</span> </span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">135</span>, <span class="fl">9.8</span>),</span>
<span id="cb38-3"><a href="#cb38-3"></a>                <span class="at">color =</span> <span class="st">"#E77500"</span>, <span class="at">linewidth =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb38-4"><a href="#cb38-4"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MCMC: &lt;span style='color:#619CFF'&gt;simulation&lt;/span&gt; versus &lt;span style='color:#E77500'&gt;theoretical&lt;/span&gt;"</span>,</span>
<span id="cb38-5"><a href="#cb38-5"></a>         <span class="at">subtitle =</span> <span class="st">"Gamma-Poisson Example"</span>,</span>
<span id="cb38-6"><a href="#cb38-6"></a>         <span class="at">caption =</span> <span class="st">"SML 320"</span>) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_markdown</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-37-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section id="quo-vadimus" class="title-slide slide level1 center">
<h1>Quo Vadimus</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># Trace plots of the 4 Markov chains</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="fu">mcmc_trace</span>(gp_sim, <span class="at">pars =</span> <span class="st">"lambda"</span>, <span class="at">size =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="06_approx_posterior_files/figure-revealjs/unnamed-chunk-38-1.png" width="960" class="r-stretch"><ul>
<li>How do we know if the MCMC calculations are complete?</li>
<li>How do we know if the MCMC calculations are reliable?</li>
<li>How does MCMC work in approximating the posterior distribution?</li>
</ul>
</section>

<section id="footnotes" class="title-slide slide level1 center">
<h1>Footnotes</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.1 (2023-06-16 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19045)

Matrix products: default


locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

time zone: America/New_York
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] lubridate_1.9.2    forcats_1.0.0      stringr_1.5.0      dplyr_1.1.2       
 [5] purrr_1.0.1        readr_2.1.4        tidyr_1.3.0        tibble_3.2.1      
 [9] ggplot2_3.4.2      tidyverse_2.0.0    rstan_2.32.5       StanHeaders_2.32.5
[13] ggtext_0.1.2       bayesplot_1.11.0  

loaded via a namespace (and not attached):
 [1] tensorA_0.36.2.1     gtable_0.3.3         xfun_0.39           
 [4] QuickJSR_1.1.3       inline_0.3.19        tzdb_0.4.0          
 [7] vctrs_0.6.3          tools_4.3.1          generics_0.1.3      
[10] stats4_4.3.1         curl_5.0.1           parallel_4.3.1      
[13] fansi_1.0.4          pkgconfig_2.0.3      checkmate_2.3.1     
[16] distributional_0.3.2 RcppParallel_5.1.7   lifecycle_1.0.3     
[19] compiler_4.3.1       farver_2.1.1         munsell_0.5.0       
[22] codetools_0.2-19     htmltools_0.5.5      yaml_2.3.7          
[25] pillar_1.9.0         abind_1.4-5          posterior_1.5.0     
[28] commonmark_1.9.0     tidyselect_1.2.0     digest_0.6.34       
[31] stringi_1.7.12       reshape2_1.4.4       labeling_0.4.2      
[34] fastmap_1.1.1        grid_4.3.1           colorspace_2.1-0    
[37] cli_3.6.1            magrittr_2.0.3       loo_2.6.0           
[40] pkgbuild_1.4.3       utf8_1.2.3           withr_2.5.0         
[43] scales_1.2.1         backports_1.4.1      timechange_0.2.0    
[46] rmarkdown_2.23       matrixStats_1.2.0    gridExtra_2.3       
[49] hms_1.1.3            evaluate_0.21        knitr_1.43          
[52] V8_4.3.2             markdown_1.7         rlang_1.1.1         
[55] gridtext_0.1.5       Rcpp_1.0.11          glue_1.6.2          
[58] xml2_1.3.4           rstudioapi_0.15.0    jsonlite_1.8.8      
[61] plyr_1.8.8           R6_2.5.1            </code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">

</div><div class="column" style="width:50%;">

</div>
</div>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"></ul>
<div class="tab-content">

</div>
</div>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="06_approx_posterior_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="06_approx_posterior_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="06_approx_posterior_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="06_approx_posterior_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="06_approx_posterior_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="06_approx_posterior_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="06_approx_posterior_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="06_approx_posterior_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="06_approx_posterior_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="06_approx_posterior_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>