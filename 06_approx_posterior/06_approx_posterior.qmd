---
title: "6: Approximating the Posterior"
author: "Derek Sollberger"
date: "2024-02-15"
# format:
#   revealjs:
#     scrollable: true
format:
  html:
    toc: true
---

\newcommand{\ds}{\displaystyle}

```{r}
#| message: false
#| warning: false

library("bayesrules")
library("ggtext")
library("gt")
library("patchwork")
library("tidyverse")

knitr::opts_chunk$set(echo = TRUE)

# tips_df <- readr::read_csv("tips.csv")
```

# Multivariate Data

##  Setting: NOAA

I will be studying weather data for a semester theme.  The main data will probably come from [NOAA](https://www.noaa.gov/) (National Oceanic and Atmospheric Administration), where the data consists of several readings (variables) from several research stations over many years.

Let $\theta$ represent the high temperature recorded.  Across $k$ research stations,

$$\vec{\theta} = (\theta_{1}, \theta_{2}, ..., \theta_{k})$$

## Bayesian Approach

If we have a vector of parameters to estimate,

$$f(\vec{\theta} | \vec{y} ) \propto \text{prior}*\text{likelihood} = f(\vec{\theta}) \cdot L(\vec{\theta} | \vec{y})$$

## Normalizing Constant

$$f(y) = \ds\int_{\theta_{1}}\int_{\theta_{2}} \cdots \int_{\theta_{k}} \! f(\vec{\theta}) \cdot L(\vec{\theta} | \vec{y} ) \, d\theta_{k} \cdots d\theta_{2} \, d\theta_{1}$$

* closed form solution probably does not exist
* very expensive computationally


# Strategy

*Approximate* the posterior distribution via simulation

* grid approximation, or
* MCMC (Monte Carlo Markov Chains)

Both produce a **sample** of $N$ $\theta$ values

$$\{ \theta^{(1)}, \theta^{(2)}, ..., \theta_{N} \}$$

that may have similar statistics to the posterior distribution of $\theta$.

## Conjugate Priors

For today, we will revisit the conjugate priors where we know a lot about the posterior distributions.

* beta-binomial

$$\begin{array}{rrcl}
  \text{prior: } & \pi & \sim & \text{Beta}(\alpha, \beta) \\
  \text{likelihood: } & Y|\pi & \sim & \text{Bin}(n, \pi) \\
  \text{posterior: } & \pi|Y & \sim & \text{Beta}(\alpha + y, \beta + n - y) \\
\end{array}$$



# Footnotes

```{r}
sessionInfo()
```

:::: {.columns}

::: {.column width="50%"}
	
:::

::: {.column width="50%"}

:::

::::

:::: {.panel-tabset}



::::